自定义中间件类

每一个中间件就是一个`class`类，在类中定义`process_request`和`process_response`方法，运行程序后浏览器请求访问每一个路径时，都会执行每一层中间件的`process_request`方法，同样在视图函数返回响应体后，在每一层中间件中也会执行`process_response`方法

```python
from django.utils.deprecation import MiddlewareMixin

class MiddleWare_1(MiddlewareMixin):

    def process_request(self,request):
        print('MiddleWare_1 to request')

    def process_response(self,request,response):
        print('MiddleWare_1 to response')
	    # 在process_response中必须有return response
        return response

class MiddleWare_2(MiddlewareMixin):

    def process_request(self,request):
        print('MiddleWare_2 to request')

    def process_response(self,request,response):
        print('MiddleWare_2 to response')

        return response
```

查看程序输出：

```python
# 执行中间件的请求过程是按照settings.py文件中的引入顺序执行process.request方法，返回响应体时的执行顺序是倒序，从最后开始执行
MiddleWare_1 to request
MiddleWare_2 to request
MiddleWare_2 to response
MiddleWare_1 to response
```



注：如果在process_request中添加return，就不会执行其他中间件类，会直接执行当前中间件的process_response方法，直接返回响应体



process_view，下载博客的流程图

process_view(self,request,classback,callback_args,callback_kwargs):

​	print(classback(callback_args)) 得到的是访问的视图函数，相当于执行了一次视图函数

​	ret=classback(callback_args)  如果在此处执行了 return，那么就不会执行视图函数了，直接被return回当前中间件的process_response方法中

​	return

具体的实际应用，会在以后读取源码时讲解